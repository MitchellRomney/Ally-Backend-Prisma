# Migration `20200306105821-item-relations-fix`

This migration has been generated by Mitchell Romney at 3/6/2020, 10:58:21 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_builtInto" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

CREATE UNIQUE INDEX "_builtInto_AB_unique" ON "public"."_builtInto"("A","B")

ALTER TABLE "public"."_builtInto" ADD FOREIGN KEY ("A")REFERENCES "public"."Item"("itemId") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_builtInto" ADD FOREIGN KEY ("B")REFERENCES "public"."Item"("itemId") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."_BuildComponents";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200305164348-fix..20200306105821-item-relations-fix
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://mitchellromney:mitchellromney@localhost:5432/ally-backend"
 }
 model Champion {
   blurb                     String        @default("")
@@ -143,10 +143,10 @@
   requiredChampion                         String            @default("")
   specialRecipe                            Int               @default(0)
   stacks                                   Int               @default(0)
   version                                  String            @default("")
-  BuildComponents_ItemTo_BuildComponents_A BuildComponents[] @relation("ItemTo_BuildComponents_A")
-  BuildComponents_ItemTo_BuildComponents_B BuildComponents[] @relation("ItemTo_BuildComponents_B")
+  builtInto                                Item[]            @relation(name: "builtInto")
+  builtFrom                                Item[]            @relation(name: "builtInto")
 }
 model Match {
   dateCreated      DateTime
@@ -406,13 +406,5 @@
   password String     @default("")
   userId   Int        @default(autoincrement()) @id
   username String?    @unique
   summoners Summoner[]
-}
-
-model BuildComponents {
-  A Item @relation("ItemTo_BuildComponents_A")
-  B Item @relation("ItemTo_BuildComponents_B")
-
-  @@map("_BuildComponents")
-  @@unique([A, B], name: "_BuildComponents_AB_unique")
 }
```


