# Migration `20200305152950-summoner-id-server-constraint`

This migration has been generated by Mitchell Romney at 3/5/2020, 3:29:50 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Summoner.allyId"

DROP INDEX "public"."Summoner.allyName"

ALTER TABLE "public"."Summoner" DROP COLUMN "allyId",
DROP COLUMN "allyName";

CREATE UNIQUE INDEX "Summoner.server_summonerId" ON "public"."Summoner"("server","summonerId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200305151553-summoner-composite-unique-restraint..20200305152950-summoner-id-server-constraint
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://mitchellromney:mitchellromney@localhost:5432/ally-backend"
 }
 model Champion {
   blurb                     String        @default("")
@@ -341,10 +341,8 @@
 }
 model Summoner {
   accountId     String        @default("")
-  allyId        String        @default("") @unique
-  allyName      String        @default("") @unique
   id            Int           @default(autoincrement()) @id
   profileIconId Int           @default(0)
   puuid         String        @default("")
   server        String        @default("")
@@ -354,8 +352,9 @@
   user          User?
   participant   Participant[]
   @@unique([server, summonerName])
+  @@unique([server, summonerId])
 }
 model SummonerSpell {
   cooldown        Int    @default(0)
```


